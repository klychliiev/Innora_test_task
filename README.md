# Innora_test_task

## Project contents 
* invoices_rotated - folder containing rotated images for testing the algorithm
* angle_detection.py - script to detect the rotation angles of input images
* predicted_angles.json - the file generated by the angle_detection.py script containing image path as a key and a predicted rotation angle as a value
* requirements.txt - libraries used in the project
* main.ipynb - notebook with additional comments (no need to run)

## Run the program 

Write the following commands in the terminal to run the program:<br>
$ python3 -m venv env <br>
$ source env/bin/activate<br>
$ pip3 install -r requirements.txt<br>
$ python3 angle_detection.py<br>

The output of the last command should be as follows:<br>
invoices_rotated/0.png: 7<br>
invoices_rotated/1.png: -2<br>
invoices_rotated/2.png: -9<br>
invoices_rotated/3.png: -7<br>
invoices_rotated/4.png: -1<br>
invoices_rotated/5.png: -6<br>
invoices_rotated/6.png: 5<br>
invoices_rotated/7.png: -2<br>
invoices_rotated/8.png: -4<br>
invoices_rotated/9.png: -1<br>
invoices_rotated/10.png: -4<br>

## Script explanation
<b>def calculate_angle()</b><br>
The opencv-python library was used to calculate the rotation angle of images. 
The Canny function is applied to the grayscale image to detect the edges. After that, the HoughLinesP function detects the lines. Once the lines are detected, the for loop is defined to loop over the lines and calculate the angle of each line with respect to the horizontal axis. These angles are stored in the 'angles' list. This function returns the median angle of all the lines in the image thus representing the overall orientation of the image.

<b>def generate_json()</b><br>
This function calculates the angle in the range of [-30,30] degrees for each rotated image in the 'invoices_rotated' folder. Lastly, the 'predicted_angles.json' file is generated. This JSON file contains a test image path as a key and a predicted angle as a value.

